@page "/"
@using BlazorMedia;
@inject IJSRuntime JSRuntime
@inject IComponentContext ComponentContext

@if (BlazorMediaAPI.Initialized)
{
    <VideoMedia OnDataReceived="@OnDataReceived" />
}

@functions {

    protected override async Task OnAfterRenderAsync()
    {
        if (!ComponentContext.IsConnected)
        {
            return;
        }

        if (!BlazorMediaAPI.Initialized)
        {
            await BlazorMediaAPI.InitializeMediaStream(JSRuntime, 640, 480, true);
            this.StateHasChanged();
        }

        await base.OnAfterRenderAsync();
    }

    protected void OnDataReceived(byte[] data)
    {
        Console.WriteLine($"Data Recieved of length: {data.Length}");
    }
}